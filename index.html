<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>rickymiyake.com</title>
  <style>
    body {
      margin: 0;
      background-color: white;
      font-family: sans-serif;
      color: black;
      overflow: hidden; /* Seite nicht scrollbar */
    }

    header {
      height: 100px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 40px;
      box-sizing: border-box;
      position: relative;
    }

    .logo-button {
      font-size: 24pt;
      font-family: "Helvetica Neue UltraLight", "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-weight: 400;
      text-decoration: none;
      color: black;
      background: none;
      border: none;
      cursor: pointer;
      overflow: hidden;
      white-space: nowrap;
      position: relative;
    }

    #typewriter {
      position: relative;
      z-index: 1;
    }

    #highlight {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background: rgba(255, 105, 180, 0.2); /* rosa mit 20% Transparenz */
      pointer-events: none;
      z-index: 0;
      transition: left 0.3s ease, width 0.3s ease;
    }

    #typewriter::after {
      content: "|";
      animation: blink 1s infinite;
      position: relative;
      z-index: 2;
    }
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
  </style>
</head>
<body>

  <header>
    <button class="logo-button" onclick="location.href='index.html'">
      <span id="typewriter"></span>
      <span id="highlight"></span>
    </button>
  </header>

  <script>
    const text = "rickymiyake.com";
    const el = document.getElementById("typewriter");
    const highlight = document.getElementById("highlight");

    let i = 0;
    let hasMistyped = false;
    let phase = "typing"; // phases: typing, mistype1, mistype2, highlight, wait, deleting

    // Berechnet Breite von Text in px (für Highlight)
    function getTextWidth(text, font) {
      const canvas = getTextWidth.canvas || (getTextWidth.canvas = document.createElement("canvas"));
      const context = canvas.getContext("2d");
      context.font = font;
      return context.measureText(text).width;
    }

    function updateHighlight(startIndex, endIndex) {
      const font = window.getComputedStyle(el).font;
      const fullText = text;
      const leftText = fullText.slice(0, startIndex);
      const highlightText = fullText.slice(startIndex, endIndex);

      const leftWidth = getTextWidth(leftText, font);
      const highlightWidth = getTextWidth(highlightText, font);

      highlight.style.left = leftWidth + "px";
      highlight.style.width = highlightWidth + "px";
    }

    function typeWriter() {
      if (phase === "typing") {
        if (i <= text.length) {
          el.textContent = text.slice(0, i++);
          updateHighlight(0, 0);
          setTimeout(typeWriter, 72); // 10% schneller (~80ms original)
        } else {
          phase = "mistype1";
          i = 5; // Position nach "rick"
          setTimeout(typeWriter, 100);
        }
      } else if (phase === "mistype1") {
        // Tippen "x" statt "m"
        el.textContent = text.slice(0, 5) + "x";
        updateHighlight(5, 6);
        setTimeout(() => {
          phase = "mistype2";
          typeWriter();
        }, 500);
      } else if (phase === "mistype2") {
        // Rückgängig machen "x"
        el.textContent = text.slice(0, 5);
        updateHighlight(0, 0);
        setTimeout(() => {
          phase = "mistype3";
          typeWriter();
        }, 200);
      } else if (phase === "mistype3") {
        // Weiter tippen von restlichem Text mit Vertippen bei ".com"
        i = 6;
        phase = "typing2";
        typeWriter();
      } else if (phase === "typing2") {
        if (i <= text.length) {
          // Vertippen ".ccom"
          if (i === text.length - 3) { // Position vor "com"
            el.textContent = text.slice(0, i) + "ccom";
            updateHighlight(i, i + 4);
            setTimeout(() => {
              phase = "mistype4";
              typeWriter();
            }, 500);
          } else {
            el.textContent = text.slice(0, i++);
            updateHighlight(0, 0);
            setTimeout(typeWriter, 72);
          }
        } else {
          phase = "highlight";
          setTimeout(typeWriter, 500);
        }
      } else if (phase === "mistype4") {
        // Rückgängig machen doppeltes c
        el.textContent = text;
        updateHighlight(0, 0);
        setTimeout(() => {
          phase = "highlight";
          typeWriter();
        }, 200);
      } else if (phase === "highlight") {
        // Highlight alles für 1 Sekunde, Cursor ausblenden
        el.style.color = "transparent";
        highlight.style.left = "0";
        highlight.style.width = getTextWidth(text, window.getComputedStyle(el).font) + "px";

        setTimeout(() => {
          el.style.color = "black";
          highlight.style.width = "0";
          phase = "wait";
          typeWriter();
        }, 1000);
      } else if (phase === "wait") {
        // Warten 2 Sekunden (ursprünglich 3 Sekunden)
        setTimeout(() => {
          el.textContent = "";
          updateHighlight(0, 0);
          phase = "typing";
          i = 0;
          typeWriter();
        }, 2000);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      // Initial highlight hidden
      highlight.style.width = "0";
      typeWriter();
    });
  </script>

</body>
</html>
